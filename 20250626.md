某CVEの内容を調べてみたら、

C言語のソースコードのバッファーオーバーランでだった。

ただ、オーバーランが起きる条件が微妙で、

○○が255より大きくて、でも○○のときはOKなのでフラグ立てときます、なチェックがあってそれをくぐり抜けてしまったときに起きる、というもので、

* そのフラグを立ててるところから使っているところまでは、巨大なswitch文があったりするし、

* そもそも関数が長すぎて最クロマチック数が天元突破してそうだし、

* 引数とした受け取ってる構造体もポインタだらけでアサーションも入ってないしで、

そりゃバグ出て当然では。

これが正しいと言おうとしたら、関数の内部はともかくとして、どう呼ばれているかまで完全に把握してないと無理なんだけど、人間でもそんなレビューできないでしょ、という感想。
